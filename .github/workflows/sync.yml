name: Check Server Architecture

on:
  push:
    branches:
      - main  # 或者你需要触发的分支
  workflow_dispatch:  # 允许手动触发工作流

jobs:
  check-architecture:
    runs-on: ubuntu-latest  # 使用 GitHub 提供的 Ubuntu runner
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v2  # 检出代码库，默认会下载你的所有文件（如果你有其他文件的话）

    - name: Get server architecture
      run: |
        # 使用 uname -m 或 arch 命令来获取架构信息
        ARCHITECTURE=$(uname -m)
        echo "The server architecture is: $ARCHITECTURE"  # 输出到控制台
        # 将架构信息写入 architecture.txt 文件
        echo "The server architecture is: $ARCHITECTURE" > architecture.txt
    
    - name: Upload architecture.txt
      uses: actions/upload-artifact@v4  # 更新为 v4 版本
      with:
        name: architecture-output
        path: architecture.txt  # 将 architecture.txt 上传为 artifact，方便后续下载查看
